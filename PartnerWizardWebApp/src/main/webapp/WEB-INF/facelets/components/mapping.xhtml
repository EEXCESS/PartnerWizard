<div xmlns="http://www.w3.org/1999/xhtml"
xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:eexcess="http://www.eexcess.eu/partnersetup"
	xmlns:syn="http://richfaces.org/sandbox/syntaxhighlighter" 
	id="mapping" style="padding-left:10px;">
	<fieldset>
		<!-- Form Name -->
		<legend>Partner API #{mappingFor}</legend>

		<!-- Text input-->
		<div class="control-group">
			<label class="control-label" for="textinput">endpoint:</label>
			<div class="controls">
				<h:inputText value="#{mappingBean.searchEndpoint}"
					styleClass="form-control" />
				<p class="help-block">URL for API</p>
			</div>
		</div>

		<!-- Text input-->
		<div class="control-group">
			<label class="control-label" for="textinput">search term:</label>
			<div class="controls">
				<h:inputText value="#{mappingBean.searchEndpointSearchTerm}"
					styleClass="form-control" />
				<p class="help-block">search term</p>
			</div>
		</div>
	</fieldset>
	<a4j:commandButton value="Call API search" execute="@form"
		action="#{mappingBean.callPartnerAPIsearch}" styleClass="btn btn-primary"
		render="apiResponseId#{mappingId}" rendered="#{mappingId =='search'}"/>
	<a4j:commandButton value="Call API detail" execute="@form"
		action="#{mappingBean.callPartnerAPIdetail}" styleClass="btn btn-primary"
		render="apiResponseId#{mappingId}"  rendered="#{mappingId !='search'}"/>

	<div class="row">
		<div>
			<h3>API Response</h3>
			<a4j:outputPanel id="apiResponseId#{mappingId}">
				<!-- 
								<p>TODO: Show here XML Reponse from the API Call</p>
								<h:outputText value="#{mappingBean.apiResponse}" escape="false"></h:outputText>
			-->

				<!-- 
								<h:inputTextarea rows="50" cols="80" value="#{mappingBean.apiResponseFormated}" readonly="true"/>
			-->
				<!-- 								<div style="max-height: 550px;overflow-y:hidden;display: inline-block;max-width: 900px;"> -->
				<!-- style="max-height: 450px;overflow-y:auto;display: inline-block;max-width: 800px;" -->
				<syn:syntaxhighlighter id="syn#{mappingId}" theme="Eclipse" language="xml"
					highlight="2" tabsize="4" gutter="false" rendered="true">
					<h:outputText value="#{mappingBean.apiResponseFormated}" />
				</syn:syntaxhighlighter>
			</a4j:outputPanel>

		</div>
		<div>
			<a4j:outputPanel id="mappingFieldsId#{mappingId}">
				<h3>Mapping to EEXCESS fields</h3>
				<div class="control-group">
					<label class="control-label" for="textinput">XPath for the
						loop:</label>
					<div class="controls">
						<h:inputText value="#{mappingBean.eexcessFieldsXPathLoop}"
							styleClass="form-control" />
						<p class="help-block">XPath for the loop</p>
					</div>
				</div>
				<h3>EEXCESS Fields</h3>
				<table class="eexcessMappingFieldsTable">
					<tr>
						<td>name</td>
						<td>description</td>
						<td>xpath</td>
						<td>value</td>
					</tr>
					<ui:repeat value="#{mappingBean.mappingFields}" var="mappingField">
						<tr>
							<td>#{mappingField.name}</td>
							<td>#{mappingField.description}</td>
							<td>
								<table>
									<tr>
										<td style="border: none;"><h:inputText
												value="#{mappingField.xPath}" styleClass="form-control" />
										</td>
										<td style="border: none;">
											<!-- execute="@form" --> <a4j:commandButton value="test"
												render="mappingFieldsId#{mappingId}" action="#{mappingBean.probeXPath}"
												styleClass="btn btn-primary">
												<a4j:param value="#{mappingField.id}"
													assignTo="#{mappingBean.actMappingFieldId}" />
											</a4j:commandButton>
										</td>
									</tr>
								</table>
							</td>
							<td>
								<ul>
									<ui:repeat value="#{mappingField.exampleValues}" var="value">
										<li>#{value}</li>
									</ui:repeat>
								</ul>
							</td>
						</tr>
					</ui:repeat>
				</table>
			</a4j:outputPanel>
		</div>
	</div>

</div>

